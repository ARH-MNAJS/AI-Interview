(()=>{var e={};e.id=690,e.ids=[690],e.modules={6472:e=>{"use strict";e.exports=require("@opentelemetry/api")},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},1424:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>g,routeModule:()=>u,serverHooks:()=>p,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>b});var a={};r.r(a),r.d(a,{GET:()=>l});var c=r(97),n=r(7278),o=r(3173),s=r(8501),i=r(9131),d=r(7920);async function l(e,{params:t}){try{let{interviewId:r}=await t;console.log("\uD83D\uDD0D [API IndividualReport] Starting request for interview:",r);let a=e.headers.get("authorization");if(!a?.startsWith("Bearer "))return console.error("âŒ [API IndividualReport] No auth header"),Response.json({success:!1,error:"Unauthorized"},{status:401});let c=a.substring(7),n=(await d.j.verifyIdToken(c)).uid;console.log("âœ… [API IndividualReport] User authenticated:",n);let o=await (0,i.ef)(n);if(!o)return console.error("âŒ [API IndividualReport] User is not TPO:",n),Response.json({success:!1,error:"TPO access required"},{status:403});console.log("âœ… [API IndividualReport] TPO access verified:",{userId:n,collegeId:o}),console.log("\uD83D\uDCE1 [API IndividualReport] Fetching attempts for interview:",r);let l=await (0,s.Ce)(r);console.log("\uD83D\uDCCA [API IndividualReport] Raw attempts from DB:",{count:l.length,attempts:l.map(e=>({feedbackId:e.feedbackId,studentName:e.studentName,college:e.college,branch:e.branch,year:e.year,totalScore:e.totalScore}))});let u=l.filter(e=>{let t=e.college===o||"N/A"===e.college;return console.log(`ðŸ” [API IndividualReport] Filtering attempt ${e.feedbackId}:`,{studentCollege:e.college,tpoCollege:o,isMatch:t}),t});return console.log("\uD83C\uDFAF [API IndividualReport] Final filtered attempts:",{originalCount:l.length,filteredCount:u.length,collegeId:o,interviewId:r}),Response.json({success:!0,attempts:u,interviewId:r,collegeId:o},{status:200})}catch(e){return console.error("âŒ [API IndividualReport] Error fetching interview attempts:",e),Response.json({success:!1,error:"Failed to fetch interview attempts"},{status:500})}}let u=new c.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/reports/[interviewId]/route",pathname:"/api/reports/[interviewId]",filename:"route",bundlePath:"app/api/reports/[interviewId]/route"},resolvedPagePath:"C:\\Users\\sudar\\Downloads\\interview-ai\\app\\api\\reports\\[interviewId]\\route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:f,workUnitAsyncStorage:b,serverHooks:p}=u;function g(){return(0,o.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:b})}},8696:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"009014325b7b1bd583f774c05c90e0e17384c4d9c2":()=>c.wR,"00be45b3173ac93d69fcb3fb8303fc683a5e143903":()=>c.HW,"00c0fa45a1a28d5c16a6a1cd96c00d8afb18bb0e1f":()=>c.JY,"00fc42ac67bd00033b3cf0566aa46eb1569b3de7c7":()=>c.CI,"4001e2350799b5b70180c9b09d6afd1d67d18b1cd7":()=>c.eE,"400474cd152df4b1763b585619d55899cc4d23ad4a":()=>c.Ak,"400ec9ec2f4989b37dac48b258fb0e8c0c57da9228":()=>c.Hh,"4030a8907117017840e541e66b3878f2958fcea903":()=>c.Jv,"40317cc706bde30e3f306e8f198075a413378b33ff":()=>a.Hc,"4047032653a9928632cb9f39d640b8bb6af14f2c77":()=>a.iI,"4067e603649f68be5a1d67c3f86d219019826049e1":()=>c.$G,"406bad0a6970c7ffc51885c00fcc2229d1f30b2718":()=>a.IV,"4080e8cde92d64d0ca432dfdd1ab765f756e9d9439":()=>a.a1,"40a5ae7fe9ce7e59a3d6cc294b10383696b4519a49":()=>a.uP,"40ad0a852413f786204b5bce3a329a487a5d02b15b":()=>a.OY,"40ad97c5c57471817a56b383d5cefeeca547ff595a":()=>a.Ce,"40b6039dc5914bcc16040feeaf3fcb60b605e330a9":()=>c.ef,"40c1dd97a55e725d42affbac1172bc1c9b2a7a00fd":()=>a.Th,"40cb38bc229f416c427f8b0c2f0a413e1dde0902d6":()=>a.zX,"6091a61179fe7d2980e5d9dcf6c42cf1bf7a48fe63":()=>a.W9});var a=r(8501),c=r(9131)},5522:()=>{},8730:()=>{},97:(e,t,r)=>{"use strict";e.exports=r(4870)},7920:(e,t,r)=>{"use strict";r.d(t,{db:()=>c,j:()=>a}),function(){var e=Error("Cannot find module 'firebase-admin/app'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module 'firebase-admin/auth'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module 'firebase-admin/firestore'");throw e.code="MODULE_NOT_FOUND",e}();let{auth:a,db:c}=(Object(function(){var e=Error("Cannot find module 'firebase-admin/app'");throw e.code="MODULE_NOT_FOUND",e}())().length||Object(function(){var e=Error("Cannot find module 'firebase-admin/app'");throw e.code="MODULE_NOT_FOUND",e}())({credential:Object(function(){var e=Error("Cannot find module 'firebase-admin/app'");throw e.code="MODULE_NOT_FOUND",e}())({projectId:process.env.FIREBASE_PROJECT_ID,clientEmail:process.env.FIREBASE_CLIENT_EMAIL,privateKey:process.env.FIREBASE_PRIVATE_KEY?.replace(/\\n/g,"\n")})}),{auth:Object(function(){var e=Error("Cannot find module 'firebase-admin/auth'");throw e.code="MODULE_NOT_FOUND",e}())(),db:Object(function(){var e=Error("Cannot find module 'firebase-admin/firestore'");throw e.code="MODULE_NOT_FOUND",e}())()})},9131:(e,t,r)=>{"use strict";r.d(t,{$G:()=>o,Ak:()=>d,CI:()=>b,HW:()=>p,Hh:()=>u,JY:()=>s,Jv:()=>f,eE:()=>i,ef:()=>l,wR:()=>g});var a=r(6780);r(7704);var c=r(7920),n=r(9389);async function o(e){let t=await (0,n.UL)(),r=await c.j.createSessionCookie(e,{expiresIn:6048e5});t.set("session",r,{maxAge:604800,httpOnly:!0,secure:!0,path:"/",sameSite:"lax"})}async function s(){try{return(await c.db.collection("colleges").get()).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Error fetching colleges:",e),[]}}async function i(e){try{let t=await c.db.collection("colleges").doc(e).get();if(!t.exists)return[];return t.data().branches||[]}catch(e){return console.error("Error fetching college branches:",e),[]}}async function d(e){try{let t=await c.db.collection("colleges").doc(e).get();if(!t.exists)return[];return t.data().years||[]}catch(e){return console.error("Error fetching college years:",e),[]}}async function l(e){try{let t=await c.db.collection("colleges").where("tpoUserId","==",e).limit(1).get();if(t.empty)return null;return t.docs[0].id}catch(e){return console.error("Error checking TPO access:",e),null}}async function u(e){let{uid:t,name:r,email:a,college:n,branch:o,year:s}=e;try{if((await c.db.collection("users").doc(t).get()).exists)return{success:!1,message:"User already exists. Please sign in."};let e={name:r,email:a};return n&&(e.college=n),o&&(e.branch=o),s&&(e.year=s),await c.db.collection("users").doc(t).set(e),{success:!0,message:"Account created successfully. Please sign in."}}catch(e){if(console.error("Error creating user:",e),"auth/email-already-exists"===e.code)return{success:!1,message:"This email is already in use"};return{success:!1,message:"Failed to create account. Please try again."}}}async function f(e){let{email:t,idToken:r}=e;try{if(!await c.j.getUserByEmail(t))return{success:!1,message:"User does not exist. Create an account."};await o(r)}catch(e){return console.log(""),{success:!1,message:"Failed to log into account. Please try again."}}}async function b(){(await (0,n.UL)()).delete("session")}async function p(){let e=await (0,n.UL)(),t=e.get("session")?.value;if(!t)return null;try{let e=await c.j.verifySessionCookie(t,!0),r=await c.db.collection("users").doc(e.uid).get();if(!r.exists)return null;return{...r.data(),id:r.id}}catch(e){return console.log(e),null}}async function g(){return!!await p()}(0,r(960).D)([o,s,i,d,l,u,f,b,p,g]),(0,a.A)(o,"4067e603649f68be5a1d67c3f86d219019826049e1",null),(0,a.A)(s,"00c0fa45a1a28d5c16a6a1cd96c00d8afb18bb0e1f",null),(0,a.A)(i,"4001e2350799b5b70180c9b09d6afd1d67d18b1cd7",null),(0,a.A)(d,"400474cd152df4b1763b585619d55899cc4d23ad4a",null),(0,a.A)(l,"40b6039dc5914bcc16040feeaf3fcb60b605e330a9",null),(0,a.A)(u,"400ec9ec2f4989b37dac48b258fb0e8c0c57da9228",null),(0,a.A)(f,"4030a8907117017840e541e66b3878f2958fcea903",null),(0,a.A)(b,"00fc42ac67bd00033b3cf0566aa46eb1569b3de7c7",null),(0,a.A)(p,"00be45b3173ac93d69fcb3fb8303fc683a5e143903",null),(0,a.A)(g,"009014325b7b1bd583f774c05c90e0e17384c4d9c2",null)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[173,526,658,501],()=>r(1424));module.exports=a})();